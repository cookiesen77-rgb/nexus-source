# 审查与修复记录（2026-01-20）

## 本次改动
- 文本节点的“AI 润色”按钮增加事件阻止，避免触发画布拖拽/冒泡。
- 润色完成后主动刷新节点内部尺寸，降低节点在渲染层“消失”的概率。
- 画布页项目菜单补齐“复制/删除”逻辑，与首页行为一致。
- 画布保存改为可延迟保存（支持 idle 调度），并降低频繁文本编辑时的写入压力。
- 项目画布落库加入队列与 idle 调度，避免高频重复写入导致卡顿。
- 工作流监听去掉 deep watch，减少大对象变更的开销。
- Tauri 增加前端错误上报到日志的通道，便于定位黑屏/崩溃。
- 节点/连线更新默认触发数组浅拷贝，确保 Vue Flow 能接收到更新。
- Tauri 远程图片缓存超时提升到 60 秒。
- Tauri 日志在 Release 也启用，并提升单文件日志上限。
- 缩放过程中临时隐藏网格/小地图以减少渲染负担。
- 图片/视频节点改为异步解码/延迟加载，降低缩放卡顿。

## 影响范围
- `TextNode` 的交互与尺寸刷新。
- `Canvas` 的项目操作、缩放性能、网格/小地图显示策略。
- `stores/canvas` 的保存策略与更新一致性。
- `stores/projects` 的落库与缩略图更新逻辑。
- `useWorkflowOrchestrator` 的监听性能。
- `main` 与 `src-tauri` 的日志采集。
- `src-tauri` 图片缓存请求的超时。
- `ImageNode`/`VideoNode` 的资源加载策略。

## 备注
- 如果仍出现“节点消失”，建议检查是否为视图缩放/拖拽导致节点移出视口，或关闭 `only-render-visible-elements` 进行对比测试。

## 追加修复（2026-01-21）
- 移除 `selectionKeyCode` 传参，避免 Vue Flow 触发类型告警并在日志中输出超大节点数据。
- 前端日志上报增加体积限制与 dataURL 清理，防止崩溃前日志暴涨导致内存压力。
- 针对“节点过多拖动画布卡顿”：使用 `moveStart/moveEnd` 进入性能模式，移动时禁用节点层指针事件、关闭过渡/阴影，并降低鼠标坐标更新频率。
